<div class="page-wrapper">
  <!-- Formulaire d'ajout -->
  <div class="form-box">
    <h2>Ajouter une tÃ¢che</h2>
    <form (ngSubmit)="editMode ? saveTask(newTask) : addTask()" class="task-form">
      <mat-form-field appearance="fill">
        <mat-label>Titre</mat-label>
        <input matInput [(ngModel)]="newTask.title" name="title" required />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Description</mat-label>
        <textarea matInput [(ngModel)]="newTask.description" name="description"></textarea>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Date limite</mat-label>
        <input matInput [matDatepicker]="picker" [(ngModel)]="newTask.dueDate" name="dueDate" />
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>

      <button mat-raised-button color="primary" type="submit">
        {{ editMode ? 'Mettre Ã  jour' : 'Ajouter' }}
      </button>
      <button *ngIf="editMode" mat-button color="warn" type="button" (click)="cancelEdit()">Annuler</button>
    </form>
  </div>

  <!-- Liste des tÃ¢ches -->
  <div class="task-list">
    <ul>
      <li *ngFor="let task of tasks; trackBy: trackById" [class.completed]="task.completed">
  <div class="task-item">
    <input type="checkbox" [(ngModel)]="task.selected" />

    <div class="task-info">
      <div *ngIf="!task.isEditing">
        <p class="task-title">{{ task.title }}</p>
        <p class="task-desc" *ngIf="task.description">{{ task.description }}</p>
        <p class="task-date" *ngIf="task.dueDate">ðŸ“… {{ task.dueDate | date }}</p>
      </div>

      <div *ngIf="task.isEditing">
        <input [(ngModel)]="task.title" placeholder="Titre" />
        <input [(ngModel)]="task.description" placeholder="Description" />
        <input [(ngModel)]="task.dueDate" [matDatepicker]="picker{ task.id }" />
        <mat-datepicker #picker{{ task.id }}></mat-datepicker>
      </div>
    </div>

    <button mat-icon-button *ngIf="!task.isEditing" (click)="task.isEditing = true">
      <mat-icon>edit</mat-icon>
    </button>

    <button mat-icon-button *ngIf="task.isEditing" (click)="saveInlineEdit(task)">
      <mat-icon>save</mat-icon>
    </button>

    <button mat-icon-button color="warn" (click)="deleteTask(task)">
      <mat-icon>delete</mat-icon>
    </button>

    <button mat-icon-button (click)="toggleTaskCompletion(task)" [color]="task.completed ? 'accent' : 'primary'">
      <mat-icon>{{ task.completed ? 'check_box' : 'check_box_outline_blank' }}</mat-icon>
    </button>
  </div>
</li>

    </ul>

    <button mat-raised-button color="warn" (click)="deleteSelectedTasks()" [disabled]="!hasSelectedTasks()">
      Supprimer la sÃ©lection
    </button>
  </div>
</div>
